{
  "name": "My workflow 14",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -20,
        0
      ],
      "id": "4eaef306-618d-4a12-9e6e-7dba3085bc47",
      "name": "When chat message received",
      "webhookId": "b806826c-c18c-481d-9b4a-9695b46fe94d"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=# Overview\nYou are the ultimate personal assistant. Your job is to send the user's query to the correct tool. You should never be writing emails, or creating even summaries, you just need to call the correct tool.\n\n## Tools\n-Call_Invoice: Use when On form submitted trigger used\n- Call_Gmail: Use this tool to take action in email\n- Call_Calendar: Use this tool to take action in calendar.\n- Call_Google_Drive: Use this tool to take action in Google Drive\n- Call_Google_Sheets: Use this tool to take action in Google Sheets\n- Tavily1: Use for search on the internet\n- RAG tool: Use it for answering questions about tax rules and/or legislation documents or anything related to la ley de IVA (always translate the answer from Spanish to English)\n## Rules\n- Some actions require you to look up contact information first. For the following actions, you must get email address and send that to the agent who needs it:\n  - sending emails\n  - drafting emails\n  - creating calendar event with attendee\n- Answering language always in English\n\n## Instructions\n1) Call the neccessary tools based on the user request\n\n\n\n\n## Final Reminders\nHere is the current date/time: {{ $now }}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        220,
        -60
      ],
      "id": "003e8179-4d6c-4c11-a956-cc171816c47a",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        140,
        160
      ],
      "id": "ee833ac1-3178-47ca-b892-4c16ddcd6a1f",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "dmq4VVpBu4CmtU1l",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "Leb8skvRbnmyOvHA",
          "mode": "list",
          "cachedResultName": "Google_Sheet_Workflow"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        860,
        120
      ],
      "id": "42180f4e-44d8-4144-8941-54f28e411547",
      "name": "Call_Google_Sheet"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "zUiviW6zPyJpoEBy",
          "mode": "list",
          "cachedResultName": "Google_Driver_Files"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        780,
        320
      ],
      "id": "8ab1caa7-7e77-44f4-93fd-82b82c9d9f9f",
      "name": "Call_Google_Drive"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "2S0MZkeQQRDR5PRE",
          "mode": "list",
          "cachedResultName": "Gmail_Assistant"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        760,
        20
      ],
      "id": "d5f6ed6f-e95a-45a0-976d-225a241c2b17",
      "name": "Call_Gmail"
    },
    {
      "parameters": {
        "toolDescription": "Use this tool to search the internet",
        "method": "POST",
        "url": "https://api.tavily.com/search",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n    \"api_key\": \"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\",\n    \"query\": \"{searchTerm}\",\n    \"search_depth\": \"basic\",\n    \"include_answer\": true,\n    \"topic\": \"news\",\n    \"include_raw_content\": true,\n    \"max_results\": 3\n} ",
        "placeholderDefinitions": {
          "values": [
            {
              "name": "searchTerm",
              "description": "What the user has requested to write a blog about",
              "type": "string"
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "typeVersion": 1.1,
      "position": [
        520,
        200
      ],
      "id": "45e05238-96f6-48ca-a189-1a7d2ed1aa83",
      "name": "Tavily1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        300,
        200
      ],
      "id": "883d87bb-a51e-4d94-b364-e833d89febc4",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "RGsq7dETLetJ0Shd",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "list",
          "cachedResultName": "documents"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.2,
      "position": [
        420,
        560
      ],
      "id": "49222676-d753-401c-b33c-4137c4c887a3",
      "name": "Supabase Vector Store",
      "credentials": {
        "supabaseApi": {
          "id": "vISXrvrZchSdQcyB",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        580,
        700
      ],
      "id": "047819f7-2375-4882-8464-ddd0e8eb779c",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "dmq4VVpBu4CmtU1l",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        680,
        500
      ],
      "id": "d667254b-713a-4c6c-aed6-6b715bb9b0ce",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "dmq4VVpBu4CmtU1l",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
      "typeVersion": 1.1,
      "position": [
        420,
        380
      ],
      "id": "9ec87d71-396e-43ee-b2af-4c8761875147",
      "name": "RAG tool"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "rnRpXa1noskWesNO",
          "mode": "list",
          "cachedResultName": "Google_Calendar"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        820,
        -160
      ],
      "id": "a81307e6-c8b6-4e50-b3ec-a3bd64f74476",
      "name": "Call_Calendar"
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Call_Google_Sheet": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call_Google_Drive": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call_Gmail": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Tavily1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Supabase Vector Store": {
      "ai_vectorStore": [
        [
          {
            "node": "RAG tool",
            "type": "ai_vectorStore",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Supabase Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "RAG tool",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "RAG tool": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call_Calendar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "79ba5fa5-bd05-4893-9701-4c04a95e0a96",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9ab3ed433c7d391ae73ed457b6cd1bad66ec5f00c3f8ec84595b45ccc6d2fdf8"
  },
  "id": "pCmHSWBiveBWaxm1",
  "tags": []
}